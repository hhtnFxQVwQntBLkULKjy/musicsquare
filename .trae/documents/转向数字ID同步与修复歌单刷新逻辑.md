# 停止维护二维码功能，全面转向数字ID同步方案

根据您的要求，我将停止修复二维码相关问题，转而实现更稳定、通用的数字 ID 同步功能，并修复歌单刷新滞后和添加歌曲失败的问题。

## 1. 后端更新 (Backend)
### `backend/worker.js`
*   **升级同步接口 (`/api/sync`)**:
    *   **支持多平台**: 扩展接口以明确支持 `netease` (网易云), `qq` (QQ音乐/Tencent), `migu` (咪咕), `kuwo` (酷我)。
    *   **纯 ID 支持**: 移除对链接格式的强制校验，直接接受并处理用户输入的数字 ID。
    *   **API 参数修正**: 调用 Meting API 时补充 `server` 参数 (如 `server=tencent`)，确保能正确区分不同平台的 ID。
*   **优化歌单接口**: 
    *   确保添加歌曲接口 (`POST /api/playlists/:id/songs`) 的健壮性，防止出现误报的 404 错误。

## 2. 前端界面重构 (Frontend)
### `js/app.js` & `home.html` (动态修改)
*   **移除二维码弹窗逻辑**:
    *   废弃 `startQrCheck` 轮询逻辑。
    *   将“扫码同步”弹窗改造为“导入歌单”弹窗。
*   **新增 ID 输入界面**:
    *   用户点击对应平台卡片后，不再显示二维码，而是显示一个输入框：“请输入您的 [平台名称] 用户 ID”。
    *   提供“开始同步”按钮，点击后调用后端同步接口。
    *   增加“如何获取 ID”的简单指引提示。

## 3. 核心 Bug 修复
### 修复：歌单不自动刷新 (Playlist Refresh)
*   **问题**: 添加歌曲后列表不更新，点击歌单仍显示旧数据。
*   **方案**: 
    *   修改侧边栏歌单的**点击事件** (`js/app.js`)：每次点击歌单时，强制从服务器重新获取该歌单的最新数据，而不是使用本地缓存。
    *   这将确保无论何时进入歌单，看到的都是最新的歌曲列表。

### 修复：添加歌曲失败 (Add Song Failure)
*   **问题**: 提示“歌曲不存在”或网络错误。
*   **方案**: 
    *   结合上述的“强制刷新”机制，确保在添加歌曲前，本地的歌单 ID 和状态是准确的。
    *   优化前端错误提示，如果后端返回具体错误原因，直接显示给用户，而不是笼统的报错。

## 执行步骤
1.  修改 `backend/worker.js` 完善同步和歌单接口。
2.  修改 `js/app.js` 实现 ID 输入 UI 和强制刷新逻辑。
3.  验证同步功能和歌单即时刷新效果。
